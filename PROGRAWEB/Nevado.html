<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Nevado de Toluca</title>
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />
    <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />

    <script defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDc9LqktSq5joZke4iOH_XvqcKup_Je2aQ&callback=initMap">
</script>

</head>


<body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand js-scroll-trigger" href="#page-top">Toluca Diviértete</a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="index.html">Home</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#photos">Galería</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#mapa">Ubicación</a>
                      </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="collapse" data-target="#collapseLogin" href="#login">Iniciar
                            Sesión</a>
                        <div class="collapse" id="collapseLogin">
                            <div class="card card-body">
                                <p><i class="fa fa-sign-in"></i>Iniciar Sesión</p>
                                <form class="formLogin">
                                    <div class="form-group" align="left">
                                        <label><i class="fa fa-user"></i>Correo Electrónico</label>
                                        <input type="email" class="form-control" name="txtUser" placeholder="Usuario"
                                            id="username" minlength="12" />
                                    </div>
                                    <div class="form-group" align="left">
                                        <label><i class="fa fa-eye-slash"></i>Contraseña</label>
                                        <input type="password" class="form-control" name="txtPass" placeholder="Usuario"
                                            id="pass" minlength="4" />
                                    </div>
                                    <p>¿No te has Registrado? <a href="registro.html">Registro</a></p>
                                    <button type="submit" class="btn btn-primary" align="center" id="btnIngresar">
                                        <i class="fa fa-sign-in"></i> Iniciar Sesión
                                    </button>
                                </form>
                            </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!--Header-->
        <header>
            <img class="img-fluid" src="assets/img/mast-nevado.png" alt="" />
        </header>

    <section class="about-destinos text-center">
                <div class="text-white col-xs-12 mx-auto tm-about-text-wrap text-center">
                    <h2 class="text-uppercase mb-4"><strong>Nevado de Toluca</strong></h2>
                    <p class="pb-5 mb-4">Nullam auctor, sapien sit amet lacinia euismod, lorem magna lobortis massa, in
                        tincidunt mi metus quis lectus. Duis nec lobortis velit. Vivamus id magna vulputate, tempor ante
                        eget, tempus augue. Maecenas ultricies neque magna.
                    </p>
                </div>
            

    </section>

    <!-- Photos-->
    <section class="projects-section bg-light" id="photos">
        <div class="container">
            <!-- Featured Project Row-->
            <div class="row align-items-center no-gutters mb-4 mb-lg-5">

                <section class="p-5 tm-container-outer tm-bg-gray">

                    <!-- The main container DIV starts here -->
                    <div class="container">
                        <div class="row">
                            <!--First row containing the main Heading-->
                            <div class="col-lg-12">
                                <h1 class="page-header">Galería</h1>
                            </div>
                            <!--Next row containing the respective images in 3x4 grids starts here -->
                            <div id="gallery_div"></div>

                        </div>
                    </div>


                </section>
                <input class="btn btn-sm btn-outline-secondary" type="file" accept='image/x-png, image/jpeg, image/jpg' id="btnFoto"/>
                <h6 id="progreso"></h6>

                <button class="btn btn-sm btn-outline-secondary" id = "btnSubir">
                            Subir Imagen
                          </button>

            </div>

        </div>
    </section>


    <!-- MAP-->

    <section id="mapa">
        <div id="map"></div>
    </section>

    <section class="contact-section bg-black style="margin: 0;">
        
        
        
        
        <div class="social d-flex justify-content-center" style="margin: 0;">
            <a class="mx-2" href="https://github.com/chocoboleda/ProgWebTurismo"><i class="fab fa-github"></i></a>
        </div>
    </section>

    <!-- Footer-->
    <footer class="footer bg-black small text-center text-white-50">
        <div class="container">Copyright © Toluca Diviértete 2020</div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Third party plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>


  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-auth.js"></script>
  
  
  <script>

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
          apiKey: "AIzaSyDc9LqktSq5joZke4iOH_XvqcKup_Je2aQ",
          authDomain: "sitio-turistico-prog-web.firebaseapp.com",
          projectId: "sitio-turistico-prog-web",
          storageBucket: "sitio-turistico-prog-web.appspot.com",
          messagingSenderId: "943450679611",
          appId: "1:943450679611:web:4e11f096b4f336d6236f1e",
          measurementId: "G-E7N3JRL0GC"
        };

        // Initialize Firebase
        var inicial = firebase.initializeApp(firebaseConfig);
        var database =  inicial.database();
        var storage = inicial.storage();
        var auth = inicial.auth();
        var btnSubir = document.getElementById("btnSubir");
        var txtNombreReg = document.getElementById("nombreReg");
        var txtApellidoReg = document.getElementById("apellidoReg");
        var txtCorreoReg = document.getElementById("correoReg");
        var txtPassReg = document.getElementById("passReg");
        var nombreFoto="";
        var urlFoto ="";
        var archivos = [];
        var usuario;
        //registro usuarios
        $("#btnSubir").click( function(){
                      subirImagen(); 
            
        });

        /// subir imagen
     function subirImagen(){
            nombreFoto = archivos.name;
            var subir = storage.ref(`imagenGaleria/${nombreFoto}`).put(archivos);
            subir.on('state_changed',function(snapshot) {
              var progreso = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
              document.getElementById("progreso").innerHTML="Progreso de Subida"+ progreso +"%";
            },
            function (error){
                console.log(error);
            },function(){
              urlFoto=storage.ref(`imagenGaleria/${nombreFoto}`).getDownloadURL().then(function (url){
                urlFoto=url;
                auth.createUserWithEmailAndPassword(txtCorreoReg.value, txtPassReg.value).then((user) => {
                  usuario.id = user.user.uid;
                  usuario.foto = urlFoto;
                   database.ref(`Nevado/${user.user.uid}`).set(usuario).then(success =>{     
                                alert("Usuario Registrado exitosamente");
                            }).catch((error)=>{
                              console.log(error.message);
                            });
                   }).catch((error) => {
                      var errorCode = error.code;
                      var errorMessage = error.message;
                      console.log(errorMessage);
                    });      
                        });
            });
        }

        $("#btnFoto").change(function(){
              cargarFoto( this );
          });

          function cargarFoto(subida) {   
              if (subida.files && subida.files[0]) {
                  archivos = subida.files[0];
              }
          }

</script>

    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>

    <script type="text/javascript" src="js/gale.js"></script>

    <script>
        // Initialize and add the map
        function initMap() {
          // The location of Uluru
          const ubi = { lat: 19.1786100, lng: -99.8211100 };
          // The map, centered at Uluru
          const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 14,
            center: ubi,
          });
          // The marker, positioned at Uluru
          const marker = new google.maps.Marker({
            position: ubi,
            map: map,
          });
        }


      </script>


</body>

</html>